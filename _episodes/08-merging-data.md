---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 08-merging-data.md in _episodes_rmd/
title: "Merging and Joining Data"
keypoints:
- Use `merge()` to stack data
- Use `merge()` to join data
- Understand joins
objectives:
- Learn how to stack data frames (ex. different years' data)
- Learn how to join - inner, outer, etc.
- Explore after a join to verify results as expected
questions: How can I combine data from different sources?
source: Rmd
teaching: 45
exercises: 10
---



## Introduction goes here

Text


~~~
library(SASxport)
library(tidyverse)
~~~
{: .language-r}



~~~
── Attaching packages ───────────────────────────────────────────────────────── tidyverse 1.2.1 ──
~~~
{: .output}



~~~
✔ ggplot2 3.2.1     ✔ purrr   0.3.2
✔ tibble  2.1.3     ✔ dplyr   0.8.3
✔ tidyr   1.0.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.4.0
~~~
{: .output}



~~~
── Conflicts ──────────────────────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
~~~
{: .output}


~~~
demographics <- read.xport('data/DEMO_I.XPT')
bmi_df <- read.xport('data/BMX_I.XPT') 
bp_df <- read.xport('data/BPX_I.XPT')
cbc_df <- read.xport('data/CBC_I.XPT')
glu_df <- read.xport('data/GLU_I.XPT')
tg_df <- read.xport('data/TRIGLY_I.XPT')
hdl_df <- read.xport('data/HDL_I.XPT')
tc_df <- read.xport('data/TCHOL_I.XPT')
# smk_df <- read.xport('data/SMQ_I.XPT')
~~~
{: .language-r}

Now that we have all the files read in, let's merge.
From bmi_df we are keeping: BMXBMI
from bp_df: PBXPLS (pules), BPXSY1 (SBP), PBXDI1 (DPB),
tg_df : LBXTR (triglycerides mg/dL), LBDLDL (LDL mg/dL)
tc_df: LBXTC (total chol mg/dL)
hdl_df: LBDHDD (HDL mg/dL)
cbc_df: LBXWBCSI (WBCs 1000cells/uL)
glu_df: LBXGLU (glucose fasting mg/dL)

HERE WE NEED TO CONSIDER DPLYR FOR JOINING. #TODO


~~~
merge_df <- merge(demographics, bmi_df[ ,c("SEQN", "BMXBMI")])
merge_df <- merge (merge_df, bp_df[ ,c("SEQN", "BPXSY1", "BPXDI1")])
merge_df <- merge(merge_df, tg_df[ , c("SEQN", "LBXTR", "LBDLDL")])
merge_df <- merge(merge_df, tc_df[ , c("SEQN", "LBXTC")])
merge_df <- merge(merge_df, hdl_df[ , c("SEQN", "LBDHDD")])
merge_df <- merge(merge_df, cbc_df[ , c("SEQN", "LBXWBCSI")])
merge_df <- merge(merge_df, glu_df[ , c("SEQN", "LBXGLU")])
~~~
{: .language-r}


~~~
write.csv(merge_df, file = 'data_out/merge.csv', row.names = FALSE)
~~~
{: .language-r}


~~~
merge_df <- read.csv("data_out/merge.csv")
~~~
{: .language-r}

Variables of interest:
BMI, BP, LDL, TC, HDL, GLU, AGE,
-We are interested in the association between TC and BMI categories. (Total chol (TC) = outcome and glucose (main predictor))

1. After merging, first look at NAs and summaries of variables.

~~~
# Look at descriptive statistics of all independent variables

summary(merge_df$LBXTC) # total chol --> outcome variable.
~~~
{: .language-r}



~~~
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   80.0   153.0   181.0   184.2   209.0   545.0     238 
~~~
{: .output}



~~~
sd(merge_df$LBXTC, na.rm = TRUE) # gives standard deviation; removes na values (na.rm=TRUE)
~~~
{: .language-r}



~~~
[1] 42.85437
~~~
{: .output}



~~~
summary(merge_df$LBXGLU) # glucose
~~~
{: .language-r}



~~~
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   21.0    94.0   101.0   110.6   111.0   479.0     219 
~~~
{: .output}



~~~
summary(merge_df$BMXBMI) # BMI
~~~
{: .language-r}



~~~
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  14.10   23.40   27.50   28.49   32.30   64.50      37 
~~~
{: .output}



~~~
summary(merge_df$BPXSY1)
~~~
{: .language-r}



~~~
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   78.0   110.0   120.0   123.2   132.0   236.0     188 
~~~
{: .output}



~~~
summary(merge_df$BPXDI1) # has 0s
~~~
{: .language-r}



~~~
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
    0.0    60.0    68.0    67.5    76.0   120.0     188 
~~~
{: .output}



~~~
summary(merge_df$RIDAGEYR) #TODO exclude people <18yo now. 
~~~
{: .language-r}



~~~
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  12.00   25.00   43.00   43.81   61.00   80.00 
~~~
{: .output}


2. Next, let's look at these variables in detail with graphs:

~~~
hist(merge_df$LBXTC, breaks = 30, xlab = "Total cholesterol (TC) (mg/dl)",  main = "Distribution of Total Cholesterol") # looks normal overall
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-1.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

~~~
hist(merge_df$LBXGLU, breaks = 100) # right skewed
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-2.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

~~~
boxplot(merge_df$LBXGLU) # looking at outliers of IV
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-3.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

~~~
hist(merge_df$BMXBMI, breaks = 50) # slightly right skewed
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-4.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

~~~
boxplot(merge_df$BMXBMI) # looking at outliers of IV
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-5.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

~~~
hist(merge_df$RIDAGEYR, breaks = 50) # if you ignore >=80 category and <=10, it's normal looking. 
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-6.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

~~~
hist(merge_df$BPXSY1, breaks = 50) # normally distributed
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-7.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

~~~
hist(merge_df$BPXDI1, breaks = 50) # normally distributed 
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-8-8.png" title="plot of chunk unnamed-chunk-8" alt="plot of chunk unnamed-chunk-8" width="612" style="display: block; margin: auto;" />

What's with very low BPXDI1 values?

~~~
low_di <- merge_df %>% filter(BPXDI1 < 40) %>% select(BPXSY1, BPXDI1)
~~~
{: .language-r}

Let's at least get rid of the 0's:


~~~
merge_df <- merge_df %>% filter(BPXDI1 > 0)
~~~
{: .language-r}

3. Let's drop anyone under the age of 25 b/c changes in TC may not be apparent in the younger age groups. 

~~~
merge25_df <- merge_df %>% filter(RIDAGEYR>=25 & RIDAGEYR<=80) #& LBXGLU<=200)

boxplot(merge25_df$LBXGLU) # looking at outliers again for outcome variable in this new dataset
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-11-1.png" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="612" style="display: block; margin: auto;" />

~~~
hist(merge25_df$LBXTC, breaks = 30, xlab = "Total cholesterol (TC) (mg/dl)",  main = "Distribution of Total Cholesterol") # Sill very right skewed but overall normal?
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-11-2.png" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="612" style="display: block; margin: auto;" />

~~~
boxplot(merge25_df$BMXBMI) # looking at outliers again for BMI
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-11-3.png" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="612" style="display: block; margin: auto;" />

~~~
# GOOOD EXERCIZE TO DO IN CLASS
# We note the outliers here based on the skewness of TC variable. 
#tc_outliers <- merge25_df %>% filter(LBXTC>350)
~~~
{: .language-r}

4.Let's do scatter plots to see linear relationship between predictors and outcome variable:

~~~
scatter.smooth(merge25_df$LBXGLU, merge25_df$LBXTC, xlab = "Glucose levels (mg/dl)", ylab = "Total Cholesterol (mg/dl)")
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-12-1.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="612" style="display: block; margin: auto;" />

~~~
scatter.smooth(merge25_df$BMXBMI, merge25_df$LBXTC, xlab = "BMI", ylab = "Total Cholesterol (mg/dl)")
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-12-2.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="612" style="display: block; margin: auto;" />

~~~
scatter.smooth(merge25_df$RIDAGEYR, merge25_df$LBXTC, xlab = "Age (years)", ylab = "Total Cholesterol (mg/dl)")
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-12-3.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="612" style="display: block; margin: auto;" />

~~~
scatter.smooth(merge25_df$BPXSY1, merge25_df$LBXTC, xlab = "SBP", ylab = "Total Cholesterol (mg/dl)")
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-12-4.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="612" style="display: block; margin: auto;" />

~~~
scatter.smooth(merge25_df$BPXDI1, merge25_df$LBXTC, xlab = "DBP", ylab = "Total Cholesterol (mg/dl)")
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-12-5.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="612" style="display: block; margin: auto;" />

~~~
scatter.smooth(merge25_df$LBDHDD, merge25_df$LBXTC, xlab = "HDL", ylab = "Total Cholesterol (mg/dl)")
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-12-6.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="612" style="display: block; margin: auto;" />

~~~
scatter.smooth(merge25_df$LBDLDL, merge25_df$LBXTC, xlab = "LDL", ylab = "Total Cholesterol (mg/dl)")
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-12-7.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="612" style="display: block; margin: auto;" />


5. Let's do a correlation matrix now

~~~
cor(merge25_df[ , c("LBXGLU", "BMXBMI", "RIDAGEYR", "BPXDI1", "BPXSY1", "LBDHDD", "LBDLDL")], use = "complete.obs") # everything looks like below 28% multicollinearity 
~~~
{: .language-r}



~~~
              LBXGLU       BMXBMI     RIDAGEYR      BPXDI1      BPXSY1
LBXGLU    1.00000000  0.172882463  0.169505022  0.06399179  0.17509119
BMXBMI    0.17288246  1.000000000  0.008561159  0.15742277  0.11216191
RIDAGEYR  0.16950502  0.008561159  1.000000000 -0.15656576  0.39985042
BPXDI1    0.06399179  0.157422766 -0.156565758  1.00000000  0.33173251
BPXSY1    0.17509119  0.112161914  0.399850424  0.33173251  1.00000000
LBDHDD   -0.17661922 -0.279511555  0.089615670 -0.05395787 -0.02633031
LBDLDL    0.02601963  0.065196088 -0.067610459  0.14634340  0.04705106
              LBDHDD      LBDLDL
LBXGLU   -0.17661922  0.02601963
BMXBMI   -0.27951155  0.06519609
RIDAGEYR  0.08961567 -0.06761046
BPXDI1   -0.05395787  0.14634340
BPXSY1   -0.02633031  0.04705106
LBDHDD    1.00000000 -0.08961191
LBDLDL   -0.08961191  1.00000000
~~~
{: .output}



~~~
# except BP sytolic and Age - is 40% corr.
~~~
{: .language-r}

BLOOD PRESSURE CATEGORIES:
https://www.heart.org/-/media/data-import/downloadables/pe-abh-what-is-high-blood-pressure-ucm_300310.pdf

6. Let's create catgegories for variables we are intersted in.

~~~
bp_cat <- function(sbp, dbp) {
 if (is.na(sbp) | is.na(dbp)){
   return(NA)
 }
  #if (sbp>=180 | dbp >=120) {
   # return("Hypertensive Crisis")
  #}
if (sbp>=140 | dbp >=90) {
    return("Hypertension Stage 2+")
  }

if ((sbp>=130 & sbp<=139) | (dbp >=80 & dbp <=89)) {
    return("Hypertension Stage 1")
  }

 if ((sbp>=120 & sbp<=129) &  dbp <80) {
    return("Elevated")
  }

  if (sbp < 120 & dbp <80) {
    return("Normal") 
  }
} 
~~~
{: .language-r}



~~~
# Converting Blood pressure into categories
# merge25_df <- merge25_df %>% mutate(bp_category = bp_cat(BPXSY1, BPXDI1))
merge25_df$bp_category <- mapply(bp_cat, merge25_df$BPXSY1, merge25_df$BPXDI1)
~~~
{: .language-r}

Let's first make sure that everything looks okay.  There are over 50 variables, so scrolling through the data frame in the viewer is not a great option.


~~~
# See what the range of text vales is
unique(merge25_df$bp_category)
~~~
{: .language-r}



~~~
[1] "Hypertension Stage 2+" "Hypertension Stage 1"  "Normal"               
[4] "Elevated"             
~~~
{: .output}



~~~
# Look at just the pertinent columns
just_bp <- merge25_df %>% select(BPXSY1, BPXDI1, bp_category) # check to make sure no NULL values and categories are correctly created
~~~
{: .language-r}


~~~
# Converting to factor 
merge25_df$bp_category <- as.factor(merge25_df$bp_category) 
merge25_df$bp_category <- relevel(merge25_df$bp_category, "Normal") #sets "normal" as reference.
str(merge25_df$bp_category)  # Observe that it's a factor
~~~
{: .language-r}



~~~
 Factor w/ 4 levels "Normal","Elevated",..: 4 3 1 1 1 2 3 3 4 3 ...
~~~
{: .output}



~~~
table(merge25_df$bp_category, useNA = "ifany")  # Inspect the values
~~~
{: .language-r}



~~~

               Normal              Elevated  Hypertension Stage 1 
                  844                   382                   504 
Hypertension Stage 2+ 
                  528 
~~~
{: .output}



~~~
barplot(table(merge25_df$bp_category)) #TODO reorder so it looks ordinal
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-17-1.png" title="plot of chunk unnamed-chunk-17" alt="plot of chunk unnamed-chunk-17" width="612" style="display: block; margin: auto;" />


~~~
# Convert BMI into categories
merge25_df$BMI_category <- cut(merge25_df$BMXBMI, breaks = c(0, 18.5, 25.0, 30.0, 35.0, 40, 100), labels = c("Underweight", "Normal", "Pre-obese", "Obesity I", "Obesity II", "Obesity III"), right = FALSE)

merge25_df$BMI_category <- relevel(merge25_df$BMI_category, "Normal") #this sets "normal" as the reference category.

summary(merge25_df$BMI_category)
~~~
{: .language-r}



~~~
     Normal Underweight   Pre-obese   Obesity I  Obesity II Obesity III 
        565          28         748         487         238         170 
       NA's 
         22 
~~~
{: .output}



~~~
barplot(table(merge25_df$BMI_category))
~~~
{: .language-r}

<img src="../fig/rmd-01-unnamed-chunk-18-1.png" title="plot of chunk unnamed-chunk-18" alt="plot of chunk unnamed-chunk-18" width="612" style="display: block; margin: auto;" />

NOTE: lm ignoes NAs (check this again though).  Make a note of this in the write up of the lesson. 

7. Simple linear regression models:

~~~
#TODO: Set appropriate reference levels in factor variables (for BP and BMI)

# glucose
lm_gluc <- lm(LBXTC ~ LBXGLU, data = merge25_df) 
summary(lm_gluc)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ LBXGLU, data = merge25_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-111.684  -29.446   -1.544   23.505  238.231 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 190.06181    2.63391  72.160   <2e-16 ***
LBXGLU        0.01634    0.02154   0.759    0.448    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 41.68 on 2118 degrees of freedom
  (138 observations deleted due to missingness)
Multiple R-squared:  0.0002716,	Adjusted R-squared:  -0.0002004 
F-statistic: 0.5755 on 1 and 2118 DF,  p-value: 0.4482
~~~
{: .output}



~~~
# bmi
lm_bmi <- lm(LBXTC ~ BMXBMI, data = merge25_df)
summary(lm_bmi)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ BMXBMI, data = merge25_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-112.31  -29.31   -1.92   23.14  352.80 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 192.80024    4.12811   46.70   <2e-16 ***
BMXBMI       -0.02175    0.13623   -0.16    0.873    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 42.34 on 2102 degrees of freedom
  (154 observations deleted due to missingness)
Multiple R-squared:  1.213e-05,	Adjusted R-squared:  -0.0004636 
F-statistic: 0.02549 on 1 and 2102 DF,  p-value: 0.8732
~~~
{: .output}



~~~
# bmi categorical
lm_bmicat <- lm(LBXTC ~ BMI_category, data = merge25_df)
summary(lm_bmicat)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ BMI_category, data = merge25_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-109.49  -29.08   -2.11   23.51  350.89 

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             189.4885     1.8549 102.157   <2e-16 ***
BMI_categoryUnderweight  -3.6423     8.5001  -0.429   0.6683    
BMI_categoryPre-obese     4.6189     2.4364   1.896   0.0581 .  
BMI_categoryObesity I     5.5952     2.7169   2.059   0.0396 *  
BMI_categoryObesity II   -0.1507     3.3597  -0.045   0.9642    
BMI_categoryObesity III  -0.6709     3.8331  -0.175   0.8611    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 42.3 on 2098 degrees of freedom
  (154 observations deleted due to missingness)
Multiple R-squared:  0.003964,	Adjusted R-squared:  0.001591 
F-statistic:  1.67 on 5 and 2098 DF,  p-value: 0.1385
~~~
{: .output}



~~~
# age
lm_age <- lm(LBXTC ~ RIDAGEYR, data = merge25_df)
summary(lm_age)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ RIDAGEYR, data = merge25_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-112.82  -29.98   -1.68   23.98  352.67 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 194.70073    3.11701  62.464   <2e-16 ***
RIDAGEYR     -0.04948    0.05676  -0.872    0.383    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 42.37 on 2119 degrees of freedom
  (137 observations deleted due to missingness)
Multiple R-squared:  0.0003585,	Adjusted R-squared:  -0.0001133 
F-statistic: 0.7599 on 1 and 2119 DF,  p-value: 0.3835
~~~
{: .output}



~~~
# hdl
lm_hdl <- lm(LBXTC ~ LBDHDD, data = merge25_df)
summary(lm_hdl)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ LBDHDD, data = merge25_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-107.32  -29.15   -2.89   24.11  361.85 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 169.00182    2.94626   57.36  < 2e-16 ***
LBDHDD        0.41623    0.05051    8.24 2.97e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 41.72 on 2119 degrees of freedom
  (137 observations deleted due to missingness)
Multiple R-squared:  0.03105,	Adjusted R-squared:  0.03059 
F-statistic: 67.91 on 1 and 2119 DF,  p-value: 2.968e-16
~~~
{: .output}



~~~
# ldl
lm_ldl <- lm(LBXTC ~ LBDLDL, data = merge25_df)
summary(lm_ldl)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ LBDLDL, data = merge25_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-43.345 -11.734  -2.138   9.132 159.410 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 72.67059    1.23937   58.63   <2e-16 ***
LBDLDL       1.04562    0.01045  100.07   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 16.54 on 1943 degrees of freedom
  (313 observations deleted due to missingness)
Multiple R-squared:  0.8375,	Adjusted R-squared:  0.8374 
F-statistic: 1.001e+04 on 1 and 1943 DF,  p-value: < 2.2e-16
~~~
{: .output}



~~~
# BP categorical
lm_bp <- lm(LBXTC ~ bp_category, data = merge25_df)
summary(lm_bp)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ bp_category, data = merge25_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-109.73  -28.11   -2.49   24.27  351.27 

Coefficients:
                                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)                       187.106      1.500 124.741  < 2e-16 ***
bp_categoryElevated                 6.625      2.673   2.478 0.013277 *  
bp_categoryHypertension Stage 1     9.380      2.450   3.829 0.000132 ***
bp_categoryHypertension Stage 2+    7.623      2.426   3.142 0.001703 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 42.21 on 2117 degrees of freedom
  (137 observations deleted due to missingness)
Multiple R-squared:  0.008736,	Adjusted R-squared:  0.007331 
F-statistic: 6.219 on 3 and 2117 DF,  p-value: 0.000334
~~~
{: .output}

#TODO  INTERACTION TERMS, look at literature to see which ones need to be created. 

Next: Just creating one big model just to see for now.

~~~
lm_model <- lm(LBXTC ~ LBXGLU + BMI_category + LBDHDD + LBDLDL + RIDAGEYR + bp_category, data = merge25_df)
summary(lm_model)
~~~
{: .language-r}



~~~

Call:
lm(formula = LBXTC ~ LBXGLU + BMI_category + LBDHDD + LBDLDL + 
    RIDAGEYR + bp_category, data = merge25_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-25.902  -7.464  -2.258   4.757  57.056 

Coefficients:
                                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                      22.113935   1.740514  12.705  < 2e-16 ***
LBXGLU                            0.032012   0.006559   4.881 1.14e-06 ***
BMI_categoryUnderweight           1.450383   2.476584   0.586 0.558187    
BMI_categoryPre-obese             2.078078   0.698570   2.975 0.002969 ** 
BMI_categoryObesity I             1.979823   0.787786   2.513 0.012047 *  
BMI_categoryObesity II            3.286414   0.971098   3.384 0.000728 ***
BMI_categoryObesity III           1.023284   1.091259   0.938 0.348512    
LBDHDD                            0.706332   0.015771  44.788  < 2e-16 ***
LBDLDL                            1.072459   0.007284 147.230  < 2e-16 ***
RIDAGEYR                          0.039687   0.017918   2.215 0.026879 *  
bp_categoryElevated               1.177434   0.771930   1.525 0.127346    
bp_categoryHypertension Stage 1   0.978239   0.713527   1.371 0.170538    
bp_categoryHypertension Stage 2+  2.172865   0.752865   2.886 0.003944 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.29 on 1919 degrees of freedom
  (326 observations deleted due to missingness)
Multiple R-squared:  0.9245,	Adjusted R-squared:  0.924 
F-statistic:  1958 on 12 and 1919 DF,  p-value: < 2.2e-16
~~~
{: .output}


