---
title: "Exploring Categorical Data"
teaching: 45
exercises: 10
questions:
- "How can I tabulate frequencies of a single categorical variable?"
- "How can I tabulate contingency tables?"
- "How can I generate a bar chart to visualize categorical data?"
- "How can I check for missing data?"
- "MAYBE: Cross-correlations??"
objectives:
- "Learn how to ..."
keypoints:
- "Use `table()` to calculate frequencies"
- "Use ... something to calculate % frequencies"
- "Use barplot()"
source: Rmd
---

```{r, include=FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("05-")
```

```{r}
swan_df <- read.delim('data/SWAN.tsv')
```
#TODO create a small exercise for students with filter and NA values.

## Introduction goes here

Histograms

Looking for null values

some basic filtering - for example, filter just to women of childbearing age, check for % of NA to pregnancy question

Checking normality of continuous 

Data cleanliness - boxplots, look for outliers

#NOTE: We will look at the association between Outcome Osteoporosis and Exposure Diabetes




We can start to ask questions like:  How many women in this data set have diabetes?  For categorical data, the `table()` function is quite handy.

```{r}
table(swan_df$DIABETE) # Frequency of Diabetes
```

If we wanted these proportions as percentages, we can take the result of `table()` and apply the `prop.table()` function:
```{r}
100*prop.table(table(swan_df$DIABETE)) #Shows 6.6% of women have diabetes
```

Contingency table between osteoporosis and arthritis - #TODO Need some words here

```{r}
100*prop.table(table(swan_df$ARTHRIT, swan_df$OSTEOPR)) #Col are osteoporosis (OP), rows are arthritis. 76.3% of women have OP and ART. 21% have OP but no ART. 
```

```{r}
library(dplyr)
swan_df <- swan_df %>% filter(OSTEOPR >=0)

unique(swan_df$OSTEOPR)
swan_df$OSTEOPR <- as.factor(swan_df$OSTEOPR)
swan_df$ARTHRIT <- as.factor(swan_df$ARTHRIT)
swan_df$DIABETE <- as.factor(swan_df$DIABETE)
```

#TODO Let's do a TableOne to look at baseline characterisitics.

NOTE: All swan data is from a single visit so we don't have to filter on anything.

# Logisitic regression:
```{r}
# Outcome
glm_logit <- glm(ARTHRIT ~ DIABETE + AGE, data=swan_df, family = "binomial")
summary(glm_logit)
exp(coef(glm_logit))


glm_logit <- glm(ARTHRIT ~ DIABETE + AGE, data=swan_df, family = "binomial")
summary(glm_logit)
exp(coef(glm_logit))
```

#TODO: Now look at Project 2 from Ada Youk's Regression class.

## Doing it with `with()`

LVISIT - Last visit to doctor
HEART = "Have you ever been told by a doctor that you had a heart attack or angina?"
MHEART = "Are you currently taking heart medication?"
ARTHRIT = "Have you ever been told by a doctor that you have arthritis?"
MARTHR = "Are you currently taking medication for arthritis?"
HIGH_BP
AGE
PHY_ACT = 
SMOKE_R = "Do you smoke cigarettes now?"
MEN_OPT = "Do you think you are: (1) Without any sign of menopause (2) Just beginning menopause (3) In the middle (4) Near the end (5) All through (-8) Don't know (.) Missing"
BMI


```{r}
with(swan_df, table(ARTHRIT, HEART))
```

```{r}
hist(swan_df$AGE)
```





